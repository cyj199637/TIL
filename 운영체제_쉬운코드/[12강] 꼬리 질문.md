## 1. 스레드를 많이 쓸수록 어플리케이션 성능이 좋아질까?

**애플리케이션 관점:**

이 질문에는 ‘해당 애플리케이션은 더 작은 작업들로 잘게 쪼개서 동시에 실행이 가능한 성격의 애플리케이션’ 이라는 암묵적인 전제가 깔려있다.

그러나 동작이 순차적으로 실행되어야만 하는 특징으로 인해 작업을 잘게 쪼개 동시에 실행하기 매우 어려운 성격의 애플리케이션이라면 스레드를 많이 쓰려고 해도 실제로 사용 가능한 스레드 수는 한계가 있다.

따라서 해당 애플리케이션의 경우 스레드 수를 계속 늘려봤자 어느 순간부터는 이점이 없다.

<br/>

**컨텍스트 스위칭 관점:**

컨텍스트 스위칭 작업도 CPU 코어에서 실행되기 때문에 스위칭 작업을 처리하는 동안에는 애플리케이션 코드가 실행되지 않는다.

이때 스위칭 작업을 위해 소비되는 CPU time이 overhead(간접 비용)로 발생한다.

- 애플리케이션과 직접적인 관련은 없지만 멀티스레딩으로 동작하기 위해 필요하기 때문

CPU 코어 수는 고정되어 있는데 스레드 수를 계속 늘리면 각 코어에서 경합하는 스레드 수가 점점 많아지고 overhead도 더 많아질 것이다.

따라서 스레드 수를 계속 늘리면 어느 순간부터는 overhead 때문에 성능 면에서 한계에 부딪힌다.

<br/>

또한 OS에 따라(ex. 리눅스) 스레드 수가 많아질수록 스레드가 할당받을 수 있는 time slice는 줄어들게 된다.

이로 인해 스레드 수가 많아질수록 컨텍스트 스위칭이 더 자주 발생하여 성능이 안 좋아진다.

<br/>

**CPU bound, I/O bound 관점:**

CPU bound 애플리케이션은 CPU를 많이 쓰기 때문에 코어 수와 비슷한 수준 이상으로 스레드 수를 늘려도 별 이점이 없다.

오히려 각 코어에서 경합하는 스레드 수가 많아질수록 컨텍스트 스위칭 때문에 overhead만 더 증가해서 성능이 안 좋아진다.

따라서 CPU bound 프로그램에서 적절한 스레드 수는 CPU 수 + 1 정도이다. (recommended by Goetz)

<br/>

반면 I/O bound 애플리케이션은 I/O 작업이 많기 때문에 CPU가 쉬고 있는 시간이 많다.

따라서 코어 수보다 2배 이상으로 스레드 수를 늘려주는 것이 overhead가 좀 더 늘긴 해도 코어들을 더 효율적으로 쓸 수 있기 때문에 성능 면에서 이점이 더 크다.

그래도 너무 많은 수의 스레드는 성능에 악영향을 끼치기 때문에 여러 상황에 맞춰서 적절한 스레드 수를 찾아야 한다.