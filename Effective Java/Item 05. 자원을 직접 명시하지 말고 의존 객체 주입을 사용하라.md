## Item 05. 자원을 직접 명시하지 말고 의존 객체 주입을 사용하라

대부분의 클래스는 여러 리소스에 의존한다. 클래스가 내부적으로 하나 이상의 자원에 의존하고, 사용하는 자원에 따라 동작이 달라진다면 정적 유틸리티 클래스나 싱글턴 방식이 적합하지 않다. 이 자원들을 클래스가 직접 만들게 해서도 안 된다. **대신 필요한 자원이나 혹은 그 자원을 만들어주는 팩토리를 생성자에 넘겨주는 것이 좋다.** 즉, 의존 객체 주입 패턴을 사용해야 한다.



### 의존 객체 주입 패턴

의존 객체 주입 패턴은 인스턴스를 생성할 때 생성자에 필요한 자원을 넘겨주는 방식이다. 의존 객체 주입은 생성자, 정적 팩토리, 빌더 등에 똑같이 응용할 수 있다.

~~~ java
public class SpellChecker {
    // 불변 보장 -> 여러 클라이언트가 공유할 수 있음
    private final Lexicon dictionary;
    
    public SpellChecker(Lexicon dictionary) {
        this.dictionary = Objects.requireNonNull(dictionary);
    }
    
    public boolean isValid(String word) { ... }
    public List<String> suggestions(String typo) { ... }
}
~~~



이 패턴의 변형으로 생성자에 리소스의 팩토리를 넘겨주는 방식이 있다. 이 방식을 사용해 클라이언트는 자신이 명시한 타입의 하위 타입이라면 무엇이든 생성할 수 있는 팩토리를 넘길 수 있다.

(팩토리: 호출할 때마다 특정 타입의 인스턴스를 반복해서 만들어주는 객체. 즉, 팩토리 메소드 패턴을 구현한 것)

그 예로 자바 8부터 들어온 `Supplier<T>` 인터페이스가 있다. 이를 입력으로 받는 메소드는 일반적으로 한정적 와일드카드 타입을 사용해 팩토리의 타입 매개변수를 제한해야 한다.

~~~ java
Mosaic create(Supplier<? extends Tile> tileFactory) { ... }
~~~



의존 객체 주입이 유연성과 테스트 용이성을 향상시켜주지만, 수많은 의존성을 가지고 있는 큰 프로젝트에서는 코드가 장황해질 수 있다. 이런 경우, 스프링 같은 의존 객체 주입 프레임워크를 사용하여 해결할 수 있다. 