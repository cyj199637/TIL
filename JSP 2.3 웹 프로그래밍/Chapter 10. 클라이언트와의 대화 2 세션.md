# Chapter 10. 클라이언트와의 대화 2: 세션

서버 세션을 사용하면 클라이언트의 상태를 저장할 수 있다. 

## 01. 세션 사용하기: session 기본 객체

세션은 오직 서버에만 생성되며, 웹 컨테이너에 정보를 보관할 때 사용한다.

![img](C:\Users\cyj19\Desktop\TIL\images\207AF90D4A91E82BAC)

* 웹 컨테이너는 기본적으로 하나의 웹 브라우저마다 하나의 세션을 생성

  → 같은 JSP 페이지라도 웹 브라우저마다 별도의 세션을 사용

* 웹 브라우저가 처음 접속할 때 세션을 생성하고, 이후로는 이미 생성된 세션을 사용

  → 웹 어플리케이션을 실행하는 동안 지속적으로 사용해야 하는 데이터를 저장하는데 적합



### 세션 ID

: 세션마다의 고유 ID

* 웹 서버는 웹 브라우저에 세션 ID를 전송
* 웹 브라우저는 웹 서버에 연결할 때마다 세션 ID를 보내서 웹 서버가 어떤 세션을 사용할지 판단할 수 있게 해줌
* 쿠키(JESSIONID)를 사용하여 웹 브라우저 - 웹 서버 간의 세션 ID 공유가 가능해짐



* 세션에 속성을 설정하면 세션이 종료되기 전까지 해당 속성 값을 사용할 수 있음

* 세션에 여러 속성을 사용해서 연관 정보를 저장하면 여러 문제점이 발생함

  ex) 이메일 주소 정보가 더 이상 필요하지 않아 세션에 저장하지 않는데, 해당 속성 값을 읽어오는 코드는 실수로 남겨둘 수 있다. 이 경우 `NullPointerException` 이 발생할 수 있고, 디버깅 하는데 불필요한 시간을 보낼 수 있다.

  → 따라서 연관 정보들은 하나의 클래스에 묶어 저장하고, 세션에는 해당 객체만 저장

* 세션을 종료하면 기존 session 객체를 제거하고, 이후 다음 요청에서 session을 사용하면 새로운 session 객체를 생성



### 1.5 세션 유효 시간

#### 최근 접근 시간

: session 객체에 가장 최근에 접근한 시간

→ 세션을 사용하는 JSP 페이지에 접근할 때마다 세션의 최근 접근 시간이 변경됨

#### 타임아웃

마지막 접근 이후 일정 시간(지정한 세션 유효 시간) 이내에 다시 세션에 접근하지 않는다면, 세션이 자동으로 종료되는 기능

* 유효 시간이 없는 상태에서 세션을 종료하지 않으면, 세션 객체가 계속 메모리에 남게 되므로 메모리 부족 현상 발생





## 04. 서블릿 컨텍스트와 세션

같은 서버라도 웹 어플리케이션이 다르다면 세션도 따로 생성된다. 즉, **서로 다른 웹 어플리케이션은 세션을 공유하지 않는다.** 세션 ID를 보관할 때 사용할 JSESSIONID 쿠키의 경로로 웹 어플리케이션의 컨텍스트 경로를 사용하기 때문이다.