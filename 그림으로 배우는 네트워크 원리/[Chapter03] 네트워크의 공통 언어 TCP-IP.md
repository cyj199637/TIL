# Chapter03. 네트워크의 공통 언어 TCP/IP
## 3-1 TCP/IP: 네트워크의 공통 언어

### TCP/IP의 계층구조

TCP/IP에서는 네트워크를 통해 통신하기 위한 기능을 계층화하고 복수의 프로토콜을 조합하여 실현했다.

TCP/IP는 4계층으로 구성된다.

- 애플리케이션층
    - 애플리케이션에서 다룰 데이터 형식과 절차를 결정한다.
    - ex) HTTP, SMTP, POP3, DNS 등
- 트랜스포트층
    - 애플리케이션에 데이터를 할당한다.
    - ex) TCP/UDP
- 인터넷층
    - 엔드투엔드 통신을 한다.
    - ex) IP, ICMP, ARP 등
- 네트워크 인터페이스층
    - 프로토콜은 자유롭게 선택할 수 있다.
    - 통신 상대와 같은 것을 사용할 필요는 없다.
    - ex) 이더넷, 무선 LAN(와이파이) 등

<br/>

각 계층에 포함된 프로토콜을 조합해 애플리케이션이 통신한다.

4계층의 프로토콜이 모두 정상적으로 제기능을 해야 통신이 이루어진다.

어떤 계층이 기능을 발휘하려면, 그 하위 계층이 정상적으로 동작한다는 것을 전제로 한다.

<br/><br/>

## 3-2 네트워크 인터페이스층과 인터넷층: 데이터를 전송하는 역할을 하는 계층

### 네트워크 인터페이스층

네트워크 인터페이스층의 역할은 같은 네트워크 내 인터페이스 간 데이터를 전송하는 것이다.

- ex)
    - 기술적인 관점에서 하나의 네트워크는 라우터와 레이어3 스위치로 구획되는 범위, 또는 레이어2 스위치로 구성하는 범위다.
    - 레이어2 스위치에 연결된 PC의 인터페이스에서 같은 레이어2 스위치에 연결된 다른 PC의 인터페이스까지 데이터를 전송할 수 있다.
    - 이때 0, 1의 디지털 데이터를 전기 신호 등의 물리적 신호로 변환해 전달한다.

네트워크 인터페이스층의 프로토콜이 통신 상대와 같아야 할 필요는 없다.

<br/>

### 인터넷층

인터넷층의 역할은 원격지 네트워크 간 데이터를 전송하는 것이다.

→ 엔드투엔드 통신

- 원격지 네트워크에서 최종적인 출발지와 목적지 사이의 데이터 전송

<br/>

- 라우터: 네트워크끼리 연결하고 데이터를 전송하는 기기
- 라우팅: 라우터에 의한 네트워크 간 전송

<br/><br/>

## 3-3 트랜스포트층과 애플리케이션층: 애플리케이션의 동작을 준비하는 계층

### 트랜스포트층

트랜스포트층의 역할은 다양한 곳에서 들어온 데이터를 적절한 애플리케이션으로 배분하는 것이다.

최하층부터 트랜스포트층까지 바르게 동작하면, 출발지와 목적지 애플리케이션 간에 데이터를 송수신할 수 있게 된다.

TCP/IP 트랜스포트층에 포함되는 프로토콜은 TCP와 UDP이다.

TCP를 이용하면, 어떤 이유로 데이터가 유실되더라도 그 사실을 검출해 데이터를 다시 보내준다.

TCP는 엔드투엔드의 신뢰성을 확보해주고 데이터를 분할/조립 등의 역할도 한다.

<br/>

### 애플리케이션층

애플리케이션층의 역할은 애플리케이션에서 다루는 데이터 형식과 처리 순서 등을 결정하는 것이다.

단순한 0과 1이 아니라 문자와 이미지 등 인간이 인식할 수 있도록 데이터를 표현한다.

<br/><br/>

## 3-4 캡슐화: 데이터 송수신 규칙

### 프로토콜의 제어정보 헤더를 만든다.

각 프로토콜에는 각각의 기능을 실현하기 위한 헤더가 필요하다.

- 헤더
    - 각 프로토콜의 처리를 하기 위한 제어 정보

<br/>

각 프로토콜은 데이터를 전송할 때 헤더를 추가한다. → 캡슐화

프로토콜이 데이터를 받으면 각 프로토콜 헤더를 바탕으로 적절하게 처리하여 헤더를 벗겨내고 다시 다른 프로토콜로 처리를 넘긴다. → 역캡슐화 / 비캡슐화

<br/>

### 물리적인 신호로 변환된다.

![Untitled](./image/img_01.png)

- 웹브라우저의 데이터에 계층의 상위 프로토콜의 차례대로 헤더를 추가해 간다.
- 마지막으로 이더넷 헤더와 FCS가 추가되면 네트워크로 내보낼 전체 데이터가 완성된다.
    - FCS(Frame Check Sequence): 에러 체크를 위한 정보
- 이용하는 이더넷의 규격에 대응하는 물리적인 신호로 데이터 전체를 변환해 전송 매체로 내보낸다.

<br/><br/>

## 3-5 TCP/IP를 이용한 통신: 데이터 수신, 전송할 때의 규칙

### 0과 1의 데이터로 되돌려서 전송한다.

네트워크 기기는 수신한 물리적인 신호를 0과 1의 데이터로 되돌린다.

그리고 각각의 네트워크 기기의 동작에 대응하는 헤더를 참조하여 데이터를 전송해 간다.

<br/>

### 헤더로 목적지를 확인하고 수신한다.

1. 웹서버 애플리케이션이 동작하는 웹서버까지 물리적인 신호가 도착하면 0과 1의 데이터로 변환한다.
2. 각 계층의 프로토콜은 각각의 헤더를 참조해 자기 앞으로 온 데이터인지 확인한다.
    1. 네트워크 인터페이스 계층에서는 FCS로 데이터에 오류가 없는지 확인한다.
3. 자기 앞으로 온 데이터가 맞다면 각 계층의 헤더를 제거해서 상위 프로토콜로 데이터 처리를 넘겨준다.